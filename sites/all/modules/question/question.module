<?php



/*
 * Implementation of hook_uses_points_actions()
 */
function question_uses_points_actions() {
  return 'addquestion';
}

/**
 * Implementation of hook_perm().
 */
function question_perm() {
  return array('Question user', 'Question add', 'Question save', 'Question ajax', 'Question edit', 'Question delete', 'Admin Panel', 'Users List', 'Question List', 'Edit Question', 'View Question');
}

/**
 * Implementation of hook_menu().
 */
function question_menu() {



  $items['question/ajax'] = array(
    'title' => ' Ajax Function',
    'page callback' => 'question_ajax',
    'access arguments' => array('Question ajax'),
    'type' => MENU_CALLBACK,
    'file' => 'question.pages.inc',
  );


  return $items;
}

function question_init() {
  drupal_add_js(drupal_get_path('module', 'question') . '/scripts/qadmin.js');


}



function clean_url($str, $replace = array(), $delimiter = '-', $qid='') {
  if (!empty($replace)) {
    $str = str_replace((array) $replace, ' ', $str);
  }

//    $clean = iconv('UTF-8', 'ASCII//TRANSLIT', $str);
//    $clean = preg_replace("/[^a-zA-Z0-9\/_|+ -]/", '', $clean);
//    $clean = strtolower(trim($clean, '-'));
//    $clean = preg_replace("/[\/_|+ -]+/", $delimiter, $clean);
//    if(!empty($qid)){
//    $clean='issue/'.$qid.'/'.$clean;
//    }

  /* URL alias for all languages */
  if (function_exists('pathauto_cleanstring')) {
    $str = pathauto_cleanstring($str);
  }

  $clean = $str;
  $clean = iconv('UTF-8', 'ASCII//TRANSLIT', $clean);
  $clean = seoname($clean);
  $clean = preg_replace("/[^a-zA-Z0-9\/_|+ -]/", '', $clean);
  //$clean = trim(ereg_replace(' +',' ',preg_replace('/[^a-zA-Z0-9\s]/','',strtolower($clean))));
  //$clean=str_replace(' ',$delimiter,$clean);
  if (strlen($clean) < 3 || strstr($clean, ' ')) {
    $clean = $str;
  }
  $clean = strtolower(trim($clean, '-'));
  $clean = preg_replace("/[\/_|+ -]+/", $delimiter, $clean);
  if (!empty($qid)) {
    $clean = 'issue/' . $qid . '/' . $clean;
  }
  return $clean;
}

function myTruncate($string, $limit, $break = " ", $pad = "") {

  // return with no change if string is shorter than $limit

  $string = drupal_convert_to_utf8($string, 'utf-8');


  if (drupal_strlen($string) <= $limit)
    return $string;
  $string = drupal_substr($string, 0, $limit);
  if (false !== ($breakpoint = strrpos($string, $break))) {
    $string = drupal_substr($string, 0, $breakpoint);
  }
  $string = str_replace("\"", "", $string);
  return $string . $pad;
}









// seo string
function seoname($seoit) {
  $seoit = str_replace('&quot;', '', $seoit);
  $seoit = str_replace('&#39;', '', $seoit);
  $seoit = str_replace('&lt;', '', $seoit);
  $seoit = str_replace('&gt;', '', $seoit);
  $seoit = str_replace('&amp;', '', $seoit);
  $seoit = str_replace('&#92;', '', $seoit);
  $seoit = str_replace('&', '', $seoit);
  $seoit = str_replace('+', '', $seoit);
  $seoit = str_replace('|', '', $seoit);
  $seoit = str_replace(';', '', $seoit);
  $seoit = str_replace('é', '', $seoit);
  $seoit = str_replace('½', '', $seoit);
  $seoit = str_replace('?', '', $seoit);
  $seoit = str_replace('=', '', $seoit);
  $seoit = str_replace('/', '', $seoit);
  $seoit = str_replace('\\', '', $seoit);
  $seoit = str_replace('@', '', $seoit);
  $seoit = str_replace('~', '', $seoit);
  $seoit = str_replace('!', '', $seoit);
  $seoit = str_replace('£', '', $seoit);
  $seoit = str_replace('$', '', $seoit);
  $seoit = str_replace('%', '', $seoit);
  $seoit = str_replace('&#287;', 'g', $seoit);
  $seoit = str_replace('&#286;', 'G', $seoit);
  $seoit = str_replace('&#305;', 'i', $seoit);
  $seoit = str_replace('&#304;', 'i', $seoit);
  $seoit = str_replace('ü', 'u', $seoit);
  $seoit = str_replace('Ü', 'U', $seoit);
  $seoit = str_replace('&#350;', 'S', $seoit);
  $seoit = str_replace('&#351;', 's', $seoit);
  $seoit = str_replace('ö', 'o', $seoit);
  $seoit = str_replace('Ö', 'O', $seoit);
  $seoit = str_replace('Ç', 'C', $seoit);
  $seoit = str_replace('ç', 'c', $seoit);
  $seoit = str_replace(':', '_', $seoit);
  $seoit = str_replace('^', '', $seoit);
  $seoit = str_replace('*', '', $seoit);
  $seoit = str_replace('_', '', $seoit);
  $seoit = str_replace('{', '', $seoit);
  $seoit = str_replace('}', '', $seoit);
  $seoit = str_replace('[', '', $seoit);
  $seoit = str_replace(']', '', $seoit);
  $seoit = str_replace('-', '', $seoit);
  $seoit = str_replace(' & ', '', $seoit);
  $seoit = str_replace('"', '', $seoit);
  $seoit = str_replace('.', '', $seoit);
  $seoit = str_replace('\'', '', $seoit);
  $seoit = str_replace(',', '', $seoit);
  $seoit = str_replace(' ', '-', $seoit);
  $seoit = str_replace(':', '', $seoit);
  $seoit = str_replace('#', '', $seoit);
  $seoit = str_replace('(', '', $seoit);
  $seoit = str_replace(')', '', $seoit);
  $seoit = str_replace('---', '-', $seoit);
  $seoit = str_replace('--', '-', $seoit);
  $seoit = strtolower($seoit);
  return $seoit;
}